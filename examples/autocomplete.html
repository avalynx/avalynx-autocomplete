<!DOCTYPE html>
<html lang="de" data-bs-theme="auto">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>DataTable | AvalynxDataTable Example</title>

	<!-- Bootstrap 5.3 -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3/dist/js/bootstrap.bundle.min.js"></script>

	<!-- Highlight.js 11.9 -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9/build/styles/default.min.css">
	<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9/build/highlight.min.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9/build/languages/javascript.min.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9/build/styles/stackoverflow-light.min.css" id="hljsTheme">
	<script>hljs.highlightAll();</script>

	<!-- AvalynxAutocomplete -->
    <link href="../src/css/avalynx-autocomplete.css" rel="stylesheet">
    <script src="../src/js/avalynx-autocomplete.js"></script>

	<!-- Example helper -->
	<link href="./css/helper.css" rel="stylesheet">
	<script src="./js/helper.js"></script>
	<script src="./js/demo-data.js"></script>
</head>
<body>

<div class="container py-5">

	<a class="btn btn-secondary float-end m-3" href=".">Back</a> <button id="modeToggle" class="btn btn-primary float-end m-3">Toggle to Dark Mode</button>

	<br/>
	<br/>
	<br/>
	<br/>
	<div class="container" id="avalynx-datatable"></div>
	<br/>
	<br/>
	<div class="alert alert-info">
		This is an example of the AvalynxDataTable. It is a simple table with some random data. The table is sortable, searchable and paginated. The data is fetched from a PHP script.
	</div>


	<div class="container py-5">
		<div class="row justify-content-center">
			<div class="col-md-10">
				<div class="card">
					<div class="card-header">
						<h5 class="mb-0">AvalynxAutocomplete Demo</h5>
					</div>
					<div class="card-body">
						<form id="demoForm">

							<h6 class="text-muted mb-3">Single Select</h6>

							<!-- Single Select: Clear Button -->
							<div class="mb-4">
								<label class="form-label">Produkt (Single Select, Clear Button)</label>
								<input
										type="text"
										id="productSearch"
										class="avalynx-autocomplete"
										data-key-name="product_id"
										placeholder="Produkt suchen..."
								>
								<small class="text-muted">clearStyle: 'button' (default)</small>
							</div>

							<!-- Single Select: Clear Icon -->
							<div class="mb-4">
								<label class="form-label">Benutzer (Single Select, Clear Icon)</label>
								<input
										type="text"
										id="userSearch"
										class="user-autocomplete"
										data-key-name="user_id"
										placeholder="Benutzer suchen..."
								>
								<small class="text-muted">clearStyle: 'icon' - X erscheint im Input</small>
							</div>

							<!-- Single Select: Pre-selected with Icon -->
							<div class="mb-4">
								<label class="form-label">Kategorie (Single Select, Vorausgewählt, Icon)</label>
								<input
										type="text"
										id="categorySearch"
										class="category-autocomplete"
										data-key-name="category_id"
										data-default-key="CAT002"
										data-default-value="Elektronik"
								>
							</div>

							<hr class="my-4">
							<h6 class="text-muted mb-3">Multi Select - Tags oberhalb</h6>

							<!-- Multi Select: Tags Above + Button -->
							<div class="mb-4">
								<label class="form-label">Tags (Tags oberhalb, Clear Button)</label>
								<input
										type="text"
										id="tagSearch"
										class="tag-autocomplete"
										data-key-name="tags"
										placeholder="Tags hinzufügen (max. 3)..."
								>
								<small class="text-muted">tagsPosition: 'above', clearStyle: 'button'</small>
							</div>

							<!-- Multi Select: Tags Above + Icon -->
							<div class="mb-4">
								<label class="form-label">Prioritäten (Tags oberhalb, Clear Icon)</label>
								<input
										type="text"
										id="prioritySearch"
										class="priority-autocomplete"
										data-key-name="priorities"
										placeholder="Prioritäten hinzufügen..."
								>
								<small class="text-muted">tagsPosition: 'above', clearStyle: 'icon'</small>
							</div>

							<hr class="my-4">
							<h6 class="text-muted mb-3">Multi Select - Tags inline</h6>

							<!-- Multi Select: Tags Inline + Button -->
							<div class="mb-4">
								<label class="form-label">Skills (Tags inline, Clear Button)</label>
								<input
										type="text"
										id="skillSearch"
										class="skill-autocomplete"
										data-key-name="skills"
										placeholder="Skills hinzufügen..."
								>
								<small class="text-muted">tagsPosition: 'inline', clearStyle: 'button'</small>
							</div>

							<!-- Multi Select: Tags Inline + Icon -->
							<div class="mb-4">
								<label class="form-label">Sprachen (Tags inline, Clear Icon)</label>
								<input
										type="text"
										id="languageSearch"
										class="language-autocomplete"
										data-key-name="languages"
										placeholder="Sprachen hinzufügen..."
								>
								<small class="text-muted">tagsPosition: 'inline', clearStyle: 'icon'</small>
							</div>

							<hr class="my-4">

							<button type="submit" class="btn btn-primary">Speichern</button>
							<button type="button" id="clearAll" class="btn btn-outline-secondary">Alle zurücksetzen</button>
						</form>

						<div id="output" class="mt-4 p-3 bg-white border rounded d-none">
							<h6>Form Data:</h6>
							<pre id="formData" class="mb-0"></pre>
						</div>
					</div>
				</div>

				<!-- Options Reference -->
				<div class="card mt-4">
					<div class="card-header">
						<h6 class="mb-0">Options Reference</h6>
					</div>
					<div class="card-body">
						<table class="table table-sm table-bordered mb-0">
							<thead>
							<tr>
								<th>Option</th>
								<th>Werte</th>
								<th>Default</th>
								<th>Beschreibung</th>
							</tr>
							</thead>
							<tbody>
							<tr>
								<td><code>tagsPosition</code></td>
								<td><code>'above'</code> | <code>'inline'</code></td>
								<td><code>'above'</code></td>
								<td>Position der Tags bei Multi-Select</td>
							</tr>
							<tr>
								<td><code>clearStyle</code></td>
								<td><code>'button'</code> | <code>'icon'</code></td>
								<td><code>'button'</code></td>
								<td>Stil des Clear-Elements</td>
							</tr>
							<tr>
								<td><code>maxSelections</code></td>
								<td>Number</td>
								<td><code>1</code></td>
								<td>1 = Single, >1 = Multi-Select</td>
							</tr>
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</div>



	<script>



		// ========== SINGLE SELECT ==========

		// Single + Button (default)
		const productAutocomplete = new AvalynxAutocomplete('.avalynx-autocomplete', {
			fetchData: async (query) => {
				const response = await fetch('php/result.php?type=products&search=' + encodeURIComponent(query));
				return await response.json();
			},
			maxItems: 5,
			clearStyle: 'button',
			onChange: (key, value) => console.log('Product:', key, value)
		}, {
			placeholder: 'Produkt suchen...',
			noResults: 'Keine Produkte gefunden'
		});

		// Single + Icon
		const userAutocomplete = new AvalynxAutocomplete('.user-autocomplete', {
			fetchData: async (query) => {
				const response = await fetch('php/result.php?type=users&search=' + encodeURIComponent(query));
				return await response.json();
			},
			clearStyle: 'icon',
			onChange: (key, value) => console.log('User:', key, value)
		}, {
			placeholder: 'Benutzer suchen...',
			noResults: 'Keine Benutzer gefunden'
		});

		// Single + Icon + Pre-selected
		const categoryAutocomplete = new AvalynxAutocomplete('.category-autocomplete', {
			data: categories,
			clearStyle: 'icon',
			onChange: (key, value) => console.log('Category:', key, value)
		});

		// ========== MULTI SELECT: TAGS ABOVE ==========

		// Tags above + Button
		const tagAutocomplete = new AvalynxAutocomplete('.tag-autocomplete', {
			data: tags,
			maxSelections: 3,
			tagsPosition: 'above',
			clearStyle: 'button',
			onChange: (keys, values) => console.log('Tags:', keys, values)
		}, {
			placeholder: 'Tags hinzufügen (max. 3)...',
			noResults: 'Keine Tags gefunden',
			removeTitle: 'Entfernen'
		});

		// Tags above + Icon + Pre-selected
		const priorityAutocomplete = new AvalynxAutocomplete('.priority-autocomplete', {
			data: priorities,
			maxSelections: 4,
			tagsPosition: 'above',
			clearStyle: 'icon',
			defaultSelections: [
				{ key: 'PRI001', value: 'Kritisch' },
				{ key: 'PRI002', value: 'Hoch' }
			],
			onChange: (keys, values) => console.log('Priorities:', keys, values)
		}, {
			placeholder: 'Prioritäten hinzufügen (max. 4)...',
			noResults: 'Keine Prioritäten gefunden',
			removeTitle: 'Entfernen'
		});

		// ========== MULTI SELECT: TAGS INLINE ==========

		// Tags inline + Button
		const skillAutocomplete = new AvalynxAutocomplete('.skill-autocomplete', {
			data: skills,
			maxSelections: 5,
			tagsPosition: 'inline',
			clearStyle: 'button',
			onChange: (keys, values) => console.log('Skills:', keys, values)
		}, {
			placeholder: 'Skills hinzufügen (max. 5)...',
			noResults: 'Keine Skills gefunden',
			removeTitle: 'Entfernen'
		});

		// Tags inline + Icon + Pre-selected
		const languageAutocomplete = new AvalynxAutocomplete('.language-autocomplete', {
			data: languages,
			maxSelections: 5,
			tagsPosition: 'inline',
			clearStyle: 'icon',
			defaultSelections: [
				{ key: 'LNG001', value: 'Deutsch' },
				{ key: 'LNG002', value: 'Englisch' }
			],
			onChange: (keys, values) => console.log('Languages:', keys, values)
		}, {
			placeholder: 'Sprachen hinzufügen (max. 5)...',
			noResults: 'Keine Sprachen gefunden',
			removeTitle: 'Entfernen'
		});

		// ========== FORM HANDLING ==========

		document.getElementById('demoForm').addEventListener('submit', (e) => {
			e.preventDefault();
			const formData = new FormData(e.target);
			const data = {};
			formData.forEach((value, key) => {
				try {
					data[key] = JSON.parse(value);
				} catch {
					data[key] = value;
				}
			});
			document.getElementById('formData').textContent = JSON.stringify(data, null, 2);
			document.getElementById('output').classList.remove('d-none');
		});

		document.getElementById('clearAll').addEventListener('click', () => {
			productAutocomplete.clear();
			userAutocomplete.clear();
			categoryAutocomplete.clear();
			tagAutocomplete.clear();
			skillAutocomplete.clear();
			priorityAutocomplete.clear();
			languageAutocomplete.clear();
			document.getElementById('output').classList.add('d-none');
		});

	</script>

	<br/>
	<h3>Source of example<a class="p-1 float-end btn btn-secondary btn-small" id="copyButton">Copy to clipboard</a></h3>
	<pre><code class="language-javascript" id="codeBlock">
new AvalynxDataTable("avalynx-datatable", {
	apiUrl: "php/result.php",
	perPage: 10,
	search: "",
	sorting: {
		"name": "asc",
		"age": "desc"
	}
}, {});
	</code></pre>

	<a href="https://github.com/avalynx/avalynx-datatable" target="_blank" class="btn btn-primary">AvalynxDataTable on GitHub</a> <a href="https://github.com/avalynx/" target="_blank" class="btn btn-primary">Avalynx on GitHub</a>

</div>
